<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <div class="wishlist-section">
        <!-- Wishlist items will be displayed here dynamically -->
      </div>
<script>
    // Handle adding to wishlist
document.querySelectorAll('.add-to-wishlist').forEach(button => {
  button.addEventListener('click', (e) => {
    e.preventDefault();

    let product = {
      product_id: button.getAttribute('data-id'),
      product_name: button.getAttribute('data-name'),
      product_price: button.getAttribute('data-price'),
      product_image: button.getAttribute('data-image'),
    };

    addToWishlist(product);
  });
});

function addToWishlist(product) {
  fetch('wishlist.php', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/x-www-form-urlencoded'
    },
    body: `product_id=${product.product_id}&product_name=${product.product_name}&product_price=${product.product_price}&product_image=${product.product_image}`
  })
  .then(response => response.json())
  .then(data => {
    if (data.status === 'success') {
      alert('Added to wishlist');
      renderWishlist();
    } else {
      alert(data.message);
    }
  });
}

// Render wishlist items
function renderWishlist() {
  fetch('wishlist.php')
  .then(response => response.json())
  .then(wishlistItems => {
    const wishlistSection = document.querySelector('.wishlist-section');
    wishlistSection.innerHTML = '';

    wishlistItems.forEach(item => {
      const wishlistItem = document.createElement('div');
      wishlistItem.classList.add('wishlist-item');
      wishlistItem.innerHTML = `
        <img src="${item.product_image}" alt="${item.product_name}" class="wishlist-item-image">
        <div class="wishlist-item-details">
          <h3>${item.product_name}</h3>
          <p class="wishlist-item-price">â‚¹${item.product_price}</p>
          <button class="move-to-cart" data-id="${item.product_id}" data-name="${item.product_name}" data-price="${item.product_price}" data-image="${item.product_image}">Move to Cart</button>
        </div>
      `;
      wishlistSection.appendChild(wishlistItem);
    });

    addMoveToCartFunctionality();
  });
}

// Handle moving wishlist item to cart
function addMoveToCartFunctionality() {
  document.querySelectorAll('.move-to-cart').forEach(button => {
    button.addEventListener('click', (e) => {
      e.preventDefault();

      let product = {
        product_id: button.getAttribute('data-id'),
        product_name: button.getAttribute('data-name'),
        product_price: button.getAttribute('data-price'),
        product_image: button.getAttribute('data-image'),
      };

      addToCart(product); // Function to add to cart
      removeFromWishlist(product.product_id); // Function to remove from wishlist
    });
  });
}

function removeFromWishlist(product_id) {
  fetch('wishlist.php', {
    method: 'DELETE',
    headers: {
      'Content-Type': 'application/x-www-form-urlencoded'
    },
    body: `product_id=${product_id}`
  })
  .then(response => response.json())
  .then(data => {
    if (data.status === 'success') {
      renderWishlist();
    } else {
      alert(data.message);
    }
  });
}

</script>      
</body>
</html>